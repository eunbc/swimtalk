<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>수영톡톡</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
</head>
<body>
    <div th:replace="~{common/nav}"></div>

    <div class="container-md" style="padding-top: 30px">
        <h2 ><span th:text="${pools.region.name}">서울시 강남구</span> 검색 결과 : <span th:text="${pools.poolList.size()}"></span>건</h2>
        <div id="map" style="width:1000px;height:400px;"></div>
        <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=9658a0981cdac6e3f884b7e50e8708a4"></script>
        <script th:inline="javascript">
            var mapContainer = document.getElementById('map'), // 지도를 표시할 div
                mapOption = {
                    center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
                    level: 3 // 지도의 확대 레벨
                };

            var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다

            // 마커를 표시할 위치와 title 객체 배열입니다
            var positions = [[${#lists.toList(pools.poolList)}]].map(function(pool) {
                return {
                    id: pool.id,
                    title: '<div style="padding:5px;">' + pool.name + '</div>',
                    latlng: new kakao.maps.LatLng(pool.mapX, pool.mapY)
                };
            });

            // 지도를 재설정할 범위정보를 가지고 있을 LatLngBounds 객체를 생성합니다
            var bounds = new kakao.maps.LatLngBounds();

            for (var i = 0; i < positions.length; i ++) {

                // // 마커를 생성합니다
                // var marker = new kakao.maps.Marker({
                //     map: map, // 마커를 표시할 지도
                //     position: positions[i].latlng, // 마커를 표시할 위치
                //     title : positions[i].title, // 마커의 타이틀, 마커에 마우스를 올리면 타이틀이 표시됩니다
                //     image : markerImage // 마커 이미지
                // });

                // 인포윈도우를 생성하고 지도에 표시합니다
                var infowindow = new kakao.maps.InfoWindow({
                    map: map, // 인포윈도우가 표시될 지도
                    position : positions[i].latlng,
                    content : positions[i].title
                });

                bounds.extend(positions[i].latlng);
            }

            map.setBounds(bounds);

            // 지도 확대 축소를 제어할 수 있는  줌 컨트롤을 생성합니다
            var zoomControl = new kakao.maps.ZoomControl();
            map.addControl(zoomControl, kakao.maps.ControlPosition.RIGHT);

        </script>

        <table class="table table-hover">
            <thead>
            <tr>
                <th scope="col">수영장</th>
                <th scope="col">웹사이트</th>
                <th scope="col">전화번호</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="pool : ${pools.poolList}">
                <td><a th:href="@{/pool/{poolId}(poolId=${pool.id})}" th:text="${pool.name}">국민 체육 수영장</a></td>
                <td><a th:href="@{'https://' + ${pool.link}}" th:text="${pool.link}" target="_blank">www.kswim.co.kr</a></td>
                <td th:text="${pool.telephone}">02-2222-3333</td>
            </tr>
            </tbody>
        </table>

    </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
</body>
</html>